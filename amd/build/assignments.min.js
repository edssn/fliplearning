define ("local_fliplearning/assignments",["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/moment","local_fliplearning/pagination","local_fliplearning/chartdynamic","local_fliplearning/pageheader","local_fliplearning/emailform","local_fliplearning/helpdialog"],function(a,b,c,d,e,f,g,h,i){"use strict";return{init:function(d){a.use(b);a.component("pagination",e);a.component("chart",f);a.component("pageheader",g);a.component("emailform",h);a.component("helpdialog",i);var j=new a({delimiters:["[[","]]"],el:"#submissions",vuetify:new b,data:function data(){return{dialog:!1,selected_users:[],modulename:"",moduleid:!1,strings:d.strings,groups:d.groups,userid:d.userid,courseid:d.courseid,timezone:d.timezone,render_has:d.profile_render,loading:!1,errors:[],pages:d.pages,submissions:d.submissions,email_strings:d.strings.email_strings,access:d.access,assigns_submissions_colors:d.assigns_submissions_colors,access_content_colors:d.access_content_colors,access_chart_categories:[],access_chart_series:[],access_chart_users:[],help_dialog:!1,help_contents:[]}},beforeMount:function beforeMount(){this.generate_access_content_data()},mounted:function mounted(){document.querySelector("#sessions-loader").style.display="none";document.querySelector("#submissions").style.display="block"},methods:{get_help_content:function get_help_content(){var a=[{title:this.strings.section_help_title,description:this.strings.section_help_description}];return a},update_interactions:function update_interactions(a){var b=this;this.loading=!0;this.errors=[];var d={action:"assignments",userid:this.userid,courseid:this.courseid,weekcode:a.weekcode,profile:this.render_has};c({method:"get",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",params:d}).then(function(a){if(200==a.status&&a.data.ok){b.submissions=a.data.data.submissions;b.access=a.data.data.access;b.generate_access_content_data()}else{b.error_messages.push(b.strings.error_network)}}).catch(function(){b.errors.push(b.strings.api_error_network)}).finally(function(){b.loading=!1});return this.data},build_assigns_submissions_chart:function build_assigns_submissions_chart(){var a={};a.chart={type:"column",backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.assigns_submissions_colors;a.xAxis={categories:this.submissions.categories,crosshair:!0};a.yAxis={min:0,title:{text:this.strings.assignsubs_chart_yaxis},allowDecimals:!1};a.tooltip={useHTML:!0,formatter:function formatter(){var a=this.x.split("</b>");a=a[0]||"";a=a.split("<b>");a=a[1]||"";var b=this.series.name,c=this.y,d=j.strings.students_text,e=j.strings.send_mail;if(1==c){d=j.strings.student_text}return"<small>"+a+"</small><br/><b>"+b+": </b>"+c+" "+d+"<br/><small>"+e+"</small>"}};a.plotOptions={series:{cursor:"pointer",point:{events:{click:function click(){var a=this.category.split("</b>");a=a[0]||"";a=a.split("<b>");a=a[1]||"";j.email_strings.subject=j.email_strings.subject_prefix+" - "+a;var b=this.x,c=this.series.colorIndex;j.dialog=!0;j.selected_users=j.submissions.users[b][c];j.moduleid=j.submissions.modules[b];j.modulename="assign"}}}}};a.series=this.submissions.data;return a},build_access_content_chart:function build_access_content_chart(){var a={};a.chart={type:"bar",backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.access_content_colors;a.xAxis={categories:this.access_chart_categories,title:{text:null},crosshair:!0};a.yAxis={min:0,title:{text:this.strings.access_chart_yaxis_label},labels:{overflow:"justify"},allowDecimals:!1};a.tooltip={useHTML:!0,formatter:function formatter(){var a=this.x,b=this.series.name,c=this.y,d=j.strings.students_text,e=j.strings.send_mail;if(1==c){d=j.strings.student_text}var f="<small>"+a+"</small><br/><b>"+b+": </b>"+c+" "+d+"<br/><small>"+e+"</small>";return f}};a.plotOptions={bar:{dataLabels:{enabled:!1}},series:{cursor:"pointer",point:{events:{click:function click(){var a=this.category;j.email_strings.subject=j.email_strings.subject_prefix+" - "+a;var b=this.x,c=this.series.colorIndex,d=j.get_users(j.access_chart_users[b][c]);j.selected_users=d;var e=j.get_moduletype(this.category);j.modulename=e.type;j.moduleid=e.id;j.dialog=!0}}}}};a.series=this.access_chart_series;return a},update_dialog:function update_dialog(a){this.dialog=a},generate_access_content_data:function generate_access_content_data(){var a=[];this.access.users.forEach(function(b){a.push(+b.id)});var b=[];this.access.types.forEach(function(a){if(a.show){b.push(a.type)}});var c=[];this.access.modules.forEach(function(a){if(b.includes(a.type)){c.push(a)}});var d=[],e=[],f=[],g=[];c.forEach(function(b){d.push(b.name);var c=b.users,h=a.filter(function(a){return!c.includes(a)});f.push(c.length);g.push(h.length);e.push([c,h])});var h=[{name:this.strings.access,data:f},{name:this.strings.no_access,data:g}];this.access_chart_categories=d;this.access_chart_series=h;this.access_chart_users=e},get_users:function get_users(a){var b=[];this.access.users.forEach(function(c){var d=+c.id;if(a.includes(d)){b.push(c)}});return b},get_moduletype:function get_moduletype(a){var b;this.access.modules.forEach(function(c){if(c.name===a){b=c}});return b},open_chart_help:function open_chart_help(a){var b=[];if("assigns_submissions"==a){b.push({title:this.strings.assigns_submissions_help_title,description:this.strings.assigns_submissions_help_description_p1});b.push({description:this.strings.assigns_submissions_help_description_p2})}else if("access_content"==a){b.push({title:this.strings.access_content_help_title,description:this.strings.access_content_help_description_p1});b.push({description:this.strings.access_content_help_description_p2})}this.help_contents=b;if(this.help_contents.length){this.help_dialog=!0}},update_help_dialog:function update_help_dialog(a){this.help_dialog=a},get_timezone:function get_timezone(){var a="".concat(this.strings.change_timezone," ").concat(this.timezone);return a}}})}}});
//# sourceMappingURL=assignments.min.js.map
