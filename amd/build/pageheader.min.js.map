{"version":3,"sources":["../src/pageheader.js"],"names":["define","Axios","template","props","data","dialog","selectedgroup","mounted","set_selected_group","methods","openHelpModal","saveInteraction","update_group","action","courseid","userid","groupid","url","window","location","href","method","M","cfg","wwwroot","params","then","reload","catch","confirm","usegroupselector","groups","length","forEach","group","selected","pluginsection","section","component","interaction","target","interactiontype"],"mappings":"AAAAA,OAAM,iCAAC,CAAC,0BAAD,CAAD,CAA+B,SAAUC,CAAV,CAAgB,CA8IjD,MA7ImB,CACfC,QAAQ,owFADO,CAqDfC,KAAK,CAAC,CACF,WADE,CAEF,WAFE,CAGF,cAHE,CAIF,YAJE,CAKF,QALE,CAMF,UANE,CAOF,QAPE,CAQF,SARE,CArDS,CA+DfC,IA/De,gBA+DT,CACF,MAAM,CACFC,MAAM,GADJ,CAEFC,aAAa,CAAG,IAFd,CAIT,CApEc,CAqEfC,OArEe,mBAqEN,CACL,KAAKC,kBAAL,EACH,CAvEc,CAwEfC,OAAO,CAAG,CACNC,aADM,yBACW,CAEb,KAAKL,MAAL,IACA,KAAKM,eAAL,EACH,CALK,CAONC,YAPM,wBAOQ,CACV,GAAIR,CAAAA,CAAI,CAAG,CACPS,MAAM,CAAG,aADF,CAEPC,QAAQ,CAAG,KAAKA,QAFT,CAGPC,MAAM,CAAG,KAAKA,MAHP,CAIPC,OAAO,CAAG,KAAKV,aAJR,CAKPW,GAAG,CAAEC,MAAM,CAACC,QAAP,CAAgBC,IALd,CAAX,CAOAnB,CAAK,CAAC,CACFoB,MAAM,CAAC,KADL,CAEFJ,GAAG,CAAEK,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,8BAFnB,CAGFC,MAAM,CAAGrB,CAHP,CAAD,CAAL,CAIGsB,IAJH,CAIQ,UAAc,CAClBP,QAAQ,CAACQ,MAAT,EACH,CAND,EAMGC,KANH,CAMS,UAAO,CACZ,GAAGC,OAAO,CAAC,wEAAD,CAAV,CAAqF,CACjFV,QAAQ,CAACQ,MAAT,EACH,CAFD,IAEK,CACDR,QAAQ,CAACQ,MAAT,EACH,CACJ,CAZD,CAaH,CA5BK,CA8BNG,gBA9BM,4BA8BY,CACd,MAAO,MAAKC,MAAL,EAAoC,CAArB,MAAKA,MAAL,CAAYC,MACrC,CAhCK,CAkCNxB,kBAlCM,8BAkCc,YAChB,GAAG,CAAC,KAAKsB,gBAAL,EAAJ,CAA6B,CACzB,MAAO,KACV,CACD,KAAKC,MAAL,CAAYE,OAAZ,CAAoB,SAAAC,CAAK,CAAI,CACzB,GAAGA,CAAK,CAACC,QAAT,CAAkB,CACd,CAAI,CAAC7B,aAAL,CAAqB4B,CACxB,CACJ,CAJD,EAKA,GAAG,CAAC,KAAK5B,aAAN,EAAiD,WAA1B,QAAO,MAAKyB,MAAL,CAAY,CAAZ,CAAjC,CAAgE,CAC5D,KAAKA,MAAL,CAAY,CAAZ,EAAeI,QAAf,IACA,KAAK7B,aAAL,CAAqB,KAAKyB,MAAL,CAAY,CAAZ,CACxB,CACJ,CA/CK,CAiDNpB,eAjDM,2BAiDa,CACf,GAAIP,CAAAA,CAAI,CAAG,CACPS,MAAM,CAAG,iBADF,CAEPuB,aAAa,CAAG,KAAKC,OAFd,CAGPC,SAAS,CAAG,KAAKD,OAHV,CAIPE,WAAW,CAAG,QAJP,CAKPC,MAAM,CAAG,qBALF,CAMPvB,GAAG,CAAEC,MAAM,CAACC,QAAP,CAAgBC,IANd,CAOPqB,eAAe,CAAE,CAPV,CAQP3B,QAAQ,CAAG,KAAKA,QART,CASPC,MAAM,CAAG,KAAKA,MATP,CAAX,CAWAd,CAAK,CAAC,CACFoB,MAAM,CAAC,KADL,CAEFJ,GAAG,WAAKK,CAAC,CAACC,GAAF,CAAMC,OAAX,gCAFD,CAGFC,MAAM,CAAGrB,CAHP,CAAD,CAAL,CAIGsB,IAJH,CAIQ,UAAO,CAAE,CAJjB,EAImBE,KAJnB,CAIyB,UAAO,CAAE,CAJlC,CAKH,CAlEK,CAxEK,CA8ItB,CA/IK,CAAN","sourcesContent":["define(['local_fliplearning/axios'], function (Axios){\r\n    const pageheader = {\r\n        template:`\r\n            <v-layout \r\n                class=\"font-weight-bold fliplearning-page-title justify-space-between align-center\" \r\n                id=\"page-header\"\r\n            >\r\n                <v-flex class=\"d-flex pa-4\">\r\n                    <span v-text=\"pagetitle\"></span>\r\n                </v-flex>\r\n            \r\n                <v-flex id=\"fml-group-selector\">\r\n                    <v-select\r\n                            attach \r\n                            v-model=\"selectedgroup\" \r\n                            v-if=\"usegroupselector()\" \r\n                            prepend-icon=\"group\" \r\n                            @change=\"update_group()\"\r\n                            :items=\"groups\" \r\n                            item-text=\"name\" \r\n                            item-value=\"id\">\r\n                    </v-select>\r\n                </v-flex>\r\n            \r\n                <v-flex \r\n                    class=\"d-flex justify-end align-center flex-grow-0 fliplearning-help-button pa-4 ml-8\" \r\n                    @click=\"openHelpModal()\"\r\n                >\r\n                    <span class=\"mr-2 caption\" v-text=\"helptitle\"></span>\r\n                    <v-icon :color=\"'#ffffff'\">help_outline</v-icon>\r\n                </v-flex>\r\n            \r\n                <v-dialog v-model=\"dialog\" width=\"500\" class=\"help-dialog\">\r\n                    <v-card>\r\n                        <v-card-title class=\"headline lighten-2 d-flex justify-center help-dialog-title\">\r\n                            <span v-text=\"helptitle\" class=\"help-modal-title mr-2\"></span><v-icon color=\"white\">help_outline</v-icon>\r\n                        </v-card-title>\r\n                        <v-card-text class=\"pt-4 pb-4 pr-8 pl-8 help-dialog-content\">\r\n                            <template v-for=\"(help, index, key) in helpcontents\">\r\n                                <v-layout class=\"mb-2\" :key=\"key\" column>\r\n                                    <v-flex class=\"d-flex justify-center\">\r\n                                        <span class=\"fliplearning-sub-title mb-2\" v-html=\"help.title\"></span>\r\n                                    </v-flex>\r\n                                    <p v-html=\"help.description\" class=\"text-justify\"></p>\r\n                                </v-layout>\r\n                            </template>\r\n                        </v-card-text>\r\n                        <v-divider class=\"ma-0\"></v-divider>\r\n                        <v-card-actions class=\"d-flex justify-center help-dialog-footer\">\r\n                            <v-btn text @click=\"dialog = false\" v-text=\"exitbutton\" class=\"ma-0 fml-btn-secondary\"></v-btn>\r\n                        </v-card-actions>\r\n                    </v-card>\r\n                </v-dialog>\r\n            </v-layout>`,\r\n        props:[\r\n            'pagetitle',\r\n            'helptitle',\r\n            'helpcontents',\r\n            'exitbutton',\r\n            'groups',\r\n            'courseid',\r\n            'userid',\r\n            'section',\r\n        ],\r\n        data(){\r\n            return{\r\n                dialog : false,\r\n                selectedgroup : null,\r\n            }\r\n        },\r\n        mounted(){\r\n            this.set_selected_group();\r\n        },\r\n        methods : {\r\n            openHelpModal () {\r\n                //console.log('Help dialog');\r\n                this.dialog = true;\r\n                this.saveInteraction();\r\n            },\r\n\r\n            update_group(){\r\n                let data = {\r\n                    action : \"changegroup\",\r\n                    courseid : this.courseid,\r\n                    userid : this.userid,\r\n                    groupid : this.selectedgroup,\r\n                    url: window.location.href,\r\n                }\r\n                Axios({\r\n                    method:'get',\r\n                    url: M.cfg.wwwroot + \"/local/fliplearning/ajax.php\",\r\n                    params : data,\r\n                }).then((response) => {\r\n                    location.reload();\r\n                }).catch((e) => {\r\n                    if(confirm(\"Error al cambiar de grupo. Necesitamos actualizar para evitar errores.\")){\r\n                        location.reload()\r\n                    }else{\r\n                        location.reload()\r\n                    }\r\n                });\r\n            },\r\n\r\n            usegroupselector(){\r\n                return this.groups && this.groups.length > 0;\r\n            },\r\n\r\n            set_selected_group(){\r\n                if(!this.usegroupselector()) {\r\n                    return null;\r\n                }\r\n                this.groups.forEach(group => {\r\n                    if(group.selected){\r\n                        this.selectedgroup = group;\r\n                    }\r\n                })\r\n                if(!this.selectedgroup && typeof(this.groups[0]) != 'undefined'){\r\n                    this.groups[0].selected = true;\r\n                    this.selectedgroup = this.groups[0];\r\n                }\r\n            },\r\n\r\n            saveInteraction () {\r\n                let data = {\r\n                    action : \"saveinteraction\",\r\n                    pluginsection : this.section,\r\n                    component : this.section,\r\n                    interaction : 'viewed',\r\n                    target : 'section_help_dialog',\r\n                    url: window.location.href,\r\n                    interactiontype: 3,\r\n                    courseid : this.courseid,\r\n                    userid : this.userid,\r\n                };\r\n                Axios({\r\n                    method:'get',\r\n                    url: `${M.cfg.wwwroot}/local/fliplearning/ajax.php`,\r\n                    params : data,\r\n                }).then((r) => {}).catch((e) => {});\r\n            },\r\n        }\r\n    }\r\n    return pageheader;\r\n})"],"file":"pageheader.min.js"}