{"version":3,"sources":["../src/assignments.js"],"names":["define","Vue","Vuetify","Axios","Moment","Pagination","Chart","Pageheader","Emailform","Alertify","init","content","console","log","use","component","vue","delimiters","el","vuetify","data","dialog","selected_users","moduleid","valid_form","subject_label","strings","email_strings","subject_rules","v","validation_subject_text","message","message_label","message_rules","validation_message_text","submit_button","cancel_button","emailform_title","sending_text","recipients","recipients_label","loader_dialog","snackbar","snackbar_text","snackbar_close_text","snackbar_close","snackbar_timeout","groups","userid","courseid","timezone","render_has","profile_render","loading","errors","pages","submissions","mounted","document","querySelector","style","display","computed","methods","get_help_content","update_interactions","week","action","weekcode","profile","method","url","M","cfg","wwwroot","params","then","response","catch","push","api_error_network","finally","build_chart_submissions","chart","type","backgroundColor","title","text","assignsubs_chart_title","xAxis","categories","crosshair","yAxis","min","assignsubs_chart_yaxis","tooltip","valueSuffix","plotOptions","series","cursor","point","events","click","serie_name","category","split","subject","subject_prefix","x","column","colorIndex","users","modules","credits","enabled","lang","noData","no_data","get_picture_url","submit","forEach","item","concat","id","$refs","form","reset","success","e","error","update_dialog","value"],"mappings":"AAAAA,OAAM,kCAAC,CAAC,wBAAD,CACC,4BADD,CAEC,0BAFD,CAGC,2BAHD,CAIC,+BAJD,CAKC,mCALD,CAMC,+BAND,CAOC,8BAPD,CAQC,6BARD,CAAD,CAUF,SAASC,CAAT,CAAcC,CAAd,CAAuBC,CAAvB,CAA8BC,CAA9B,CAAsCC,CAAtC,CAAkDC,CAAlD,CAAyDC,CAAzD,CAAqEC,CAArE,CAA+EC,CAA/E,CAAyF,CACrF,aAmNA,MAAO,CACHC,IAAI,CAlNR,SAAcC,CAAd,CAAuB,CACnBC,OAAO,CAACC,GAAR,CAAYF,CAAZ,EACAV,CAAG,CAACa,GAAJ,CAAQZ,CAAR,EACAD,CAAG,CAACc,SAAJ,CAAc,YAAd,CAA4BV,CAA5B,EACAJ,CAAG,CAACc,SAAJ,CAAc,OAAd,CAAuBT,CAAvB,EACAL,CAAG,CAACc,SAAJ,CAAc,YAAd,CAA4BR,CAA5B,EACAN,CAAG,CAACc,SAAJ,CAAc,WAAd,CAA2BP,CAA3B,EACA,GAAIQ,CAAAA,CAAG,CAAG,GAAIf,CAAAA,CAAJ,CAAQ,CACdgB,UAAU,CAAE,CAAC,IAAD,CAAO,IAAP,CADE,CAEdC,EAAE,CAAE,cAFU,CAGdC,OAAO,CAAE,GAAIjB,CAAAA,CAHC,CAIdkB,IAJc,gBAIP,CACH,MAAO,CACHC,MAAM,GADH,CAEHC,cAAc,CAAG,EAFd,CAGHC,QAAQ,GAHL,CAIHC,UAAU,GAJP,CAKHC,aAAa,CAAEd,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BF,aAL1C,CAMHG,aAAa,CAAE,CACX,SAAAC,CAAC,QAAI,CAAC,CAACA,CAAF,EAAOlB,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BG,uBAAzC,CADU,CANZ,CASHC,OAAO,CAAE,EATN,CAUHC,aAAa,CAAErB,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BK,aAV1C,CAWHC,aAAa,CAAE,CACX,SAAAJ,CAAC,QAAI,CAAC,CAACA,CAAF,EAAOlB,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BO,uBAAzC,CADU,CAXZ,CAcHC,aAAa,CAAExB,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BQ,aAd1C,CAeHC,aAAa,CAAEzB,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BS,aAf1C,CAgBHC,eAAe,CAAE1B,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BU,eAhB5C,CAiBHC,YAAY,CAAE3B,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BW,YAjBzC,CAkBHC,UAAU,CAAE5B,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8Ba,gBAlBvC,CAoBHC,aAAa,GApBV,CAsBHC,QAAQ,GAtBL,CAuBHC,aAAa,CAAEhC,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BgB,aAvB1C,CAwBHC,mBAAmB,CAAEjC,CAAO,CAACe,OAAR,CAAgBC,aAAhB,CAA8BkB,cAxBhD,CAyBHC,gBAAgB,CAAE,GAzBf,CA2BHpB,OAAO,CAAGf,CAAO,CAACe,OA3Bf,CA4BHqB,MAAM,CAAGpC,CAAO,CAACoC,MA5Bd,CA6BHC,MAAM,CAAGrC,CAAO,CAACqC,MA7Bd,CA8BHC,QAAQ,CAAGtC,CAAO,CAACsC,QA9BhB,CA+BHC,QAAQ,CAAGvC,CAAO,CAACuC,QA/BhB,CAgCHC,UAAU,CAAGxC,CAAO,CAACyC,cAhClB,CAiCHC,OAAO,GAjCJ,CAkCHC,MAAM,CAAG,EAlCN,CAmCHC,KAAK,CAAG5C,CAAO,CAAC4C,KAnCb,CAoCHC,WAAW,CAAE7C,CAAO,CAAC6C,WApClB,CAqCH7B,aAAa,CAAEhB,CAAO,CAACe,OAAR,CAAgBC,aArC5B,CAuCV,CA5Ca,CAsDd8B,OAtDc,mBAsDL,CACLC,QAAQ,CAACC,aAAT,CAAuB,kBAAvB,EAA2CC,KAA3C,CAAiDC,OAAjD,CAA2D,MAA3D,CACAH,QAAQ,CAACC,aAAT,CAAuB,cAAvB,EAAuCC,KAAvC,CAA6CC,OAA7C,CAAuD,OAC1D,CAzDa,CA0DdC,QAAQ,CAAE,EA1DI,CA6DdC,OAAO,CAAG,CACNC,gBADM,4BACY,CAEd,sBACH,CAJK,CAMNC,mBANM,8BAMcC,CANd,CAMmB,YACrB,KAAKb,OAAL,IAEA,KAAKC,MAAL,CAAc,EAAd,CACA,GAAIlC,CAAAA,CAAI,CAAG,CACP+C,MAAM,CAAG,aADF,CAEPnB,MAAM,CAAG,KAAKA,MAFP,CAGPC,QAAQ,CAAG,KAAKA,QAHT,CAIPmB,QAAQ,CAAGF,CAAI,CAACE,QAJT,CAKPC,OAAO,CAAG,KAAKlB,UALR,CAAX,CAOAhD,CAAK,CAAC,CACFmE,MAAM,CAAC,KADL,CAEFC,GAAG,CAAEC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,8BAFnB,CAGFC,MAAM,CAAGvD,CAHP,CAAD,CAAL,CAIGwD,IAJH,CAIQ,SAACC,CAAD,CAAc,CAElB,CAAI,CAACrB,WAAL,CAAmBqB,CAAQ,CAACzD,IAAT,CAAcoC,WACpC,CAPD,EAOGsB,KAPH,CAOS,UAAO,CACZ,CAAI,CAACxB,MAAL,CAAYyB,IAAZ,CAAiB,CAAI,CAACrD,OAAL,CAAasD,iBAA9B,CACH,CATD,EASGC,OATH,CASW,UAAM,CACb,CAAI,CAAC5B,OAAL,GACH,CAXD,EAYA,MAAO,MAAKjC,IACf,CA9BK,CAgCN8D,uBAhCM,mCAgCoB,CACtB,GAAIC,CAAAA,CAAK,GAAT,CACAA,CAAK,CAACA,KAAN,CAAc,CACVC,IAAI,CAAE,QADI,CAEVC,eAAe,CAAE,SAFP,CAAd,CAIAF,CAAK,CAACG,KAAN,CAAc,CACVC,IAAI,CAAE,KAAK7D,OAAL,CAAa8D,sBADT,CAAd,CAGAL,CAAK,CAACM,KAAN,CAAc,CACVC,UAAU,CAAE,KAAKlC,WAAL,CAAiBkC,UADnB,CAEVC,SAAS,GAFC,CAAd,CAIAR,CAAK,CAACS,KAAN,CAAc,CACVC,GAAG,CAAE,CADK,CAEVP,KAAK,CAAE,CACHC,IAAI,CAAE,KAAK7D,OAAL,CAAaoE,sBADhB,CAFG,CAAd,CAMAX,CAAK,CAACY,OAAN,CAAgB,CACZC,WAAW,CAAE,cADD,CAAhB,CAGAb,CAAK,CAACc,WAAN,CAAoB,CAChBC,MAAM,CAAE,CACJC,MAAM,CAAE,SADJ,CAEAC,KAAK,CAAE,CACPC,MAAM,CAAE,CACJC,KAAK,CAAE,gBAAY,CACf,GAAIC,CAAAA,CAAU,CAAG,KAAKC,QAAL,CAAcC,KAAd,CAAoB,MAApB,CAAjB,CACAF,CAAU,CAAGA,CAAU,CAAC,CAAD,CAAV,EAAiB,EAA9B,CACAA,CAAU,CAAGA,CAAU,CAACE,KAAX,CAAiB,KAAjB,CAAb,CACAF,CAAU,CAAGA,CAAU,CAAC,CAAD,CAAV,EAAiB,EAA9B,CACAvF,CAAG,CAACW,aAAJ,CAAkB+E,OAAlB,CAA4B1F,CAAG,CAACW,aAAJ,CAAkBgF,cAAlB,CAAiC,KAAjC,CAAuCJ,CAAnE,CALe,GAOXK,CAAAA,CAAC,CAAG,KAAKA,CAPE,CAQXC,CAAM,CAAG,KAAKX,MAAL,CAAYY,UARV,CASf9F,CAAG,CAACK,MAAJ,IACAL,CAAG,CAACM,cAAJ,CAAqBN,CAAG,CAACwC,WAAJ,CAAgBuD,KAAhB,CAAsBH,CAAtB,EAAyBC,CAAzB,CAArB,CACA7F,CAAG,CAACO,QAAJ,CAAeP,CAAG,CAACwC,WAAJ,CAAgBwD,OAAhB,CAAwBJ,CAAxB,CAClB,CAbG,CADD,CAFP,CADQ,CAApB,CAsBAzB,CAAK,CAACe,MAAN,CAAe,KAAK1C,WAAL,CAAiBpC,IAAhC,CACA+D,CAAK,CAAC8B,OAAN,CAAgB,CACZC,OAAO,GADK,CAAhB,CAGA/B,CAAK,CAACgC,IAAN,CAAa,CACTC,MAAM,CAAE,KAAK1F,OAAL,CAAa2F,OADZ,CAAb,CAGA,MAAOlC,CAAAA,CACV,CApFK,CAsFNmC,eAtFM,0BAsFUtE,CAtFV,CAsFiB,CACnB,GAAIuB,CAAAA,CAAG,WAAMC,CAAC,CAACC,GAAF,CAAMC,OAAZ,gCAA0C1B,CAA1C,WAAP,CACA,MAAOuB,CAAAA,CACV,CAzFK,CA2FNgD,MA3FM,kBA2FI,YACFhF,CAAU,CAAG,EADX,CAEN,KAAKjB,cAAL,CAAoBkG,OAApB,CAA4B,SAAAC,CAAI,CAAI,CAChClF,CAAU,CAACA,CAAU,CAACmF,MAAX,CAAkBD,CAAI,CAACE,EAAvB,CAA0B,GAA1B,CACd,CAFD,EAGA,KAAKlF,aAAL,IACA,KAAKa,MAAL,CAAc,EAAd,CACA,GAAIlC,CAAAA,CAAI,CAAG,CACP+C,MAAM,CAAG,UADF,CAEPuC,OAAO,CAAG,KAAKA,OAFR,CAGPnE,UAAU,CAAGA,CAHN,CAIPgD,IAAI,CAAG,KAAKxD,OAJL,CAKPiB,MAAM,CAAG,KAAKA,MALP,CAMPC,QAAQ,CAAG,KAAKA,QANT,CAOP1B,QAAQ,CAAG,KAAKA,QAPT,CAAX,CASAX,OAAO,CAACC,GAAR,CAAYO,CAAZ,EACAjB,CAAK,CAAC,CACFmE,MAAM,CAAC,KADL,CAEFC,GAAG,CAAEC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,8BAFnB,CAGFC,MAAM,CAAGvD,CAHP,CAAD,CAAL,CAIGwD,IAJH,CAIQ,SAACC,CAAD,CAAc,CAClBjE,OAAO,CAACC,GAAR,CAAYgE,CAAZ,EACA,CAAI,CAACpC,aAAL,IACA,CAAI,CAACpB,MAAL,IACA,CAAI,CAACqB,QAAL,IACA,CAAI,CAACkF,KAAL,CAAWC,IAAX,CAAgBC,KAAhB,GACArH,CAAQ,CAACsH,OAAT,CAAiB,CAAI,CAACpF,aAAtB,CACH,CAXD,EAWGmC,KAXH,CAWS,SAACkD,CAAD,CAAO,CACZpH,OAAO,CAACC,GAAR,CAAYmH,CAAZ,EAEAvH,CAAQ,CAACwH,KAAT,CAAe,0CAAf,EACA,CAAI,CAACxF,aAAL,GAGH,CAlBD,CAmBH,CA/HK,CAkINqF,KAlIM,iBAkIG,CACL,KAAKzG,MAAL,GACH,CApIK,CAsIN6G,aAtIM,wBAsISC,CAtIT,CAsIgB,CAClB,KAAK9G,MAAL,CAAc8G,CACjB,CAxIK,CA7DI,CAAR,CAwMb,CAEM,CAGV,CAjOC,CAAN","sourcesContent":["define([\"local_fliplearning/vue\",\r\n        \"local_fliplearning/vuetify\",\r\n        \"local_fliplearning/axios\",\r\n        \"local_fliplearning/moment\",\r\n        \"local_fliplearning/pagination\",\r\n        \"local_fliplearning/chartcomponent\",\r\n        \"local_fliplearning/pageheader\",\r\n        \"local_fliplearning/emailform\",\r\n        \"local_fliplearning/alertify\",\r\n    ],\r\n    function(Vue, Vuetify, Axios, Moment, Pagination, Chart, Pageheader, Emailform,Alertify) {\r\n        \"use strict\";\r\n\r\n        function init(content) {\r\n            console.log(content);\r\n            Vue.use(Vuetify)\r\n            Vue.component('pagination', Pagination);\r\n            Vue.component('chart', Chart);\r\n            Vue.component('pageheader', Pageheader);\r\n            Vue.component('emailform', Emailform);\r\n            let vue = new Vue({\r\n                delimiters: [\"[[\", \"]]\"],\r\n                el: \"#submissions\",\r\n                vuetify: new Vuetify(),\r\n                data() {\r\n                    return {\r\n                        dialog : false,\r\n                        selected_users : [],\r\n                        moduleid : false,\r\n                        valid_form: true,\r\n                        subject_label: content.strings.email_strings.subject_label,\r\n                        subject_rules: [\r\n                            v => !!v || content.strings.email_strings.validation_subject_text,\r\n                        ],\r\n                        message: '',\r\n                        message_label: content.strings.email_strings.message_label,\r\n                        message_rules: [\r\n                            v => !!v || content.strings.email_strings.validation_message_text,\r\n                        ],\r\n                        submit_button: content.strings.email_strings.submit_button,\r\n                        cancel_button: content.strings.email_strings.cancel_button,\r\n                        emailform_title: content.strings.email_strings.emailform_title,\r\n                        sending_text: content.strings.email_strings.sending_text,\r\n                        recipients: content.strings.email_strings.recipients_label,\r\n\r\n                        loader_dialog: false,\r\n\r\n                        snackbar: false,\r\n                        snackbar_text: content.strings.email_strings.snackbar_text,\r\n                        snackbar_close_text: content.strings.email_strings.snackbar_close,\r\n                        snackbar_timeout: 3000,\r\n\r\n                        strings : content.strings,\r\n                        groups : content.groups,\r\n                        userid : content.userid,\r\n                        courseid : content.courseid,\r\n                        timezone : content.timezone,\r\n                        render_has : content.profile_render,\r\n                        loading : false,\r\n                        errors : [],\r\n                        pages : content.pages,\r\n                        submissions: content.submissions,\r\n                        email_strings: content.strings.email_strings,\r\n                    }\r\n                },\r\n\r\n                // watch: {\r\n                //     loader_dialog (val) {\r\n                //         if (!val) return\r\n                //\r\n                //         setTimeout(() => (this.loader_dialog = false, this.dialog = false, this.snackbar = true, this.$refs.form.reset()), 4000)\r\n                //     },\r\n                // },\r\n\r\n                mounted(){\r\n                    document.querySelector(\"#sessions-loader\").style.display = \"none\";\r\n                    document.querySelector(\"#submissions\").style.display = \"block\";\r\n                },\r\n                computed :{\r\n\r\n                },\r\n                methods : {\r\n                    get_help_content(){\r\n                        let helpcontents = `Texto de Ayuda`;\r\n                        return helpcontents;\r\n                    },\r\n\r\n                    update_interactions(week){\r\n                        this.loading = true;\r\n                        let validresponse = false;\r\n                        this.errors = [];\r\n                        let data = {\r\n                            action : \"assignments\",\r\n                            userid : this.userid,\r\n                            courseid : this.courseid,\r\n                            weekcode : week.weekcode,\r\n                            profile : this.render_has,\r\n                        }\r\n                        Axios({\r\n                            method:'get',\r\n                            url: M.cfg.wwwroot + \"/local/fliplearning/ajax.php\",\r\n                            params : data,\r\n                        }).then((response) => {\r\n                            validresponse = true;\r\n                            this.submissions = response.data.submissions;\r\n                        }).catch((e) => {\r\n                            this.errors.push(this.strings.api_error_network);\r\n                        }).finally(() => {\r\n                            this.loading = false;\r\n                        });\r\n                        return this.data;\r\n                    },\r\n\r\n                    build_chart_submissions() {\r\n                        let chart = new Object();\r\n                        chart.chart = {\r\n                            type: 'column',\r\n                            backgroundColor: '#FAFAFA',\r\n                        };\r\n                        chart.title = {\r\n                            text: this.strings.assignsubs_chart_title,\r\n                        };\r\n                        chart.xAxis = {\r\n                            categories: this.submissions.categories,\r\n                            crosshair: true,\r\n                        };\r\n                        chart.yAxis = {\r\n                            min: 0,\r\n                            title: {\r\n                                text: this.strings.assignsubs_chart_yaxis\r\n                            }\r\n                        };\r\n                        chart.tooltip = {\r\n                            valueSuffix: \" estudiantes\",\r\n                        };\r\n                        chart.plotOptions = {\r\n                            series: {\r\n                                cursor: 'pointer',\r\n                                    point: {\r\n                                    events: {\r\n                                        click: function () {\r\n                                            let serie_name = this.category.split('</b>');\r\n                                            serie_name = serie_name[0] || '';\r\n                                            serie_name = serie_name.split('<b>');\r\n                                            serie_name = serie_name[1] || '';\r\n                                            vue.email_strings.subject = vue.email_strings.subject_prefix+\" - \"+serie_name;\r\n\r\n                                            let x = this.x;\r\n                                            let column = this.series.colorIndex;\r\n                                            vue.dialog = true;\r\n                                            vue.selected_users = vue.submissions.users[x][column];\r\n                                            vue.moduleid = vue.submissions.modules[x];\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        };\r\n                        chart.series = this.submissions.data;\r\n                        chart.credits = {\r\n                            enabled: false\r\n                        };\r\n                        chart.lang = {\r\n                            noData: this.strings.no_data,\r\n                        };\r\n                        return chart;\r\n                    },\r\n\r\n                    get_picture_url(userid){\r\n                        let url = `${M.cfg.wwwroot}/user/pix.php?file=/${userid}/f1.jpg`;\r\n                        return url;\r\n                    },\r\n\r\n                    submit () {\r\n                        let recipients = \"\";\r\n                        this.selected_users.forEach(item => {\r\n                            recipients=recipients.concat(item.id,\",\");\r\n                        });\r\n                        this.loader_dialog = true;\r\n                        this.errors = [];\r\n                        let data = {\r\n                            action : \"sendmail\",\r\n                            subject : this.subject,\r\n                            recipients : recipients,\r\n                            text : this.message,\r\n                            userid : this.userid,\r\n                            courseid : this.courseid,\r\n                            moduleid : this.moduleid,\r\n                        };\r\n                        console.log(data);\r\n                        Axios({\r\n                            method:'get',\r\n                            url: M.cfg.wwwroot + \"/local/fliplearning/ajax.php\",\r\n                            params : data,\r\n                        }).then((response) => {\r\n                            console.log(response);\r\n                            this.loader_dialog = false;\r\n                            this.dialog = false;\r\n                            this.snackbar = true;\r\n                            this.$refs.form.reset();\r\n                            Alertify.success(this.snackbar_text);\r\n                        }).catch((e) => {\r\n                            console.log(e);\r\n                            // this.errors.push(this.strings.api_error_network);\r\n                            Alertify.error('Error en la comunicacion con el servidor');\r\n                            this.loader_dialog = false;\r\n                            // this.dialog = false;\r\n                            // this.$refs.form.reset();\r\n                        });\r\n                    },\r\n\r\n\r\n                    reset () {\r\n                        this.dialog = false;\r\n                    },\r\n\r\n                    update_dialog (value) {\r\n                        this.dialog = value;\r\n                    }\r\n                }\r\n            })\r\n        }\r\n\r\n        return {\r\n            init : init\r\n        };\r\n    });"],"file":"assignments.min.js"}