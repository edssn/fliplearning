define ("local_fliplearning/logs",["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/alertify","local_fliplearning/pageheader"],function(a,b,c,d,e){"use strict";return{init:function(f){c.defaults.timeout=7200000;a.use(b);a.component("pageheader",e);new a({delimiters:["[[","]]"],el:"#teacher_logs",vuetify:new b,data:{strings:f.strings,courseId:f.courseId,userId:f.userId,timezone:f.timezone,dates:[],datesLabels:[],loadingBtnFliplearningLogs:!1,loadingBtnMoodleLogs:!1,helpDialog:!1,helpTitle:null,helpDescription:null,helpTableHeaders:null,helpTableItems:null,moodle_logs:"moodle_logs",fliplearning_logs:"fliplearning_logs",pluginSectionName:"teacher_download_logs"},mounted:function mounted(){document.querySelector("#teacher_logs_loader").style.display="none";document.querySelector("#teacher_logs").style.display="block"},computed:{dateRangeText:function dateRangeText(){var a=this,b=this.dates.map(function(a){return new Date(a)});b.sort(this.sortDates);this.datesLabels=b.map(function(b){return a.formatDate(b)});return this.datesLabels.join(" \u2192 ")}},methods:{getHelpContent:function getHelpContent(){var a=[{title:this.strings.sectionHelpTitle,description:this.strings.sectionHelpDescription}];return a},getFile:function getFile(a){var b=this;if(!this.datesLabels.length){d.error(this.strings.logsWithoutDatesValidation);return}if("moodle"===a){this.loadingBtnMoodleLogs=!0}else if("fliplearning"===a){this.loadingBtnFliplearningLogs=!0}else{return}var e=this.datesLabels[0].split("/").reverse().join("-"),f=this.datesLabels[1]?this.datesLabels[1].split("/").reverse().join("-"):e,g={action:"downloadlogs",logstype:a,userid:this.userId,courseid:this.courseId,startdate:e,enddate:f,url:window.location.href};c({method:"post",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",timeout:7200000,params:g}).then(function(a){if(200==a.status&&a.data.ok){var c=a.data.message,e="".concat(M.cfg.wwwroot,"/local/fliplearning/downloads/").concat(c),f=document.createElement("a");f.href=e;f.click();d.success(b.strings.logsSuccessDownload)}else if(a.data.message){d.error(a.data.message)}else{d.error(b.strings.apiErrorNetwork)}}).catch(function(){d.error(b.strings.apiErrorNetwork)}).finally(function(){"moodle"===a?b.loadingBtnMoodleLogs=!1:b.loadingBtnFliplearningLogs=!1})},sortDates:function sortDates(c,a){return a.getTime()>c.getTime()?-1:a.getTime()<c.getTime()?1:0},formatDate:function formatDate(a){var b=a.getUTCFullYear(),c=a.getUTCMonth()+1,d=10>c?"0".concat(c):c,e=a.getUTCDate(),f=10>e?"0".concat(e):e;return"".concat(f,"/").concat(d,"/").concat(b)},getTimezone:function getTimezone(){var a="".concat(this.strings.changeTimezone," ").concat(this.timezone);return a},openChartHelp:function openChartHelp(a){if(a===this.moodle_logs||a===this.fliplearning_logs){this.prepareHelpData(a)}else{return}this.helpDialog=!0;this.saveInteraction(a,"viewed","help_dialog",7)},prepareHelpData:function prepareHelpData(a){this.helpTableHeaders=[{text:this.strings.logsHelpTableHeaderColumn,value:"column"},{text:this.strings.logsHelpTableHeaderDescription,value:"description",sortable:!1}];if(a===this.moodle_logs){this.helpTitle=this.strings.moodleLogsHelpTitle;this.helpDescription=this.strings.moodleLogsHelpDescription;this.helpTableItems=[{column:this.strings.logsHeaderLogid,description:this.strings.logsHeaderLogIdHelpDescription},{column:this.strings.logsHeaderUserId,description:this.strings.logsHeaderUserIdHelpDescription},{column:this.strings.logsHeaderUsername,description:this.strings.logsHeaderUsernameHelpDescription},{column:this.strings.logsHeaderFirstname,description:this.strings.logsHeaderFirstnameHelpDescription},{column:this.strings.logsHeaderLastname,description:this.strings.logsHeaderLastnameHelpDescription},{column:this.strings.logsHeaderRoles,description:this.strings.logsHeaderRolesHelpDescription},{column:this.strings.logsHeaderCourseId,description:this.strings.logsHeaderCourseIdHelpDescription},{column:this.strings.logsHeaderCoursename,description:this.strings.logsHeaderCoursenameHelpDescription},{column:this.strings.logsHeaderContextLevel,description:this.strings.logsHeaderContextLevelHelpDescription},{column:this.strings.logsHeaderComponent,description:this.strings.logsHeaderComponentHelpDescription},{column:this.strings.logsHeaderAction,description:this.strings.logsHeaderActionHelpDescription},{column:this.strings.logsHeaderTarget,description:this.strings.logsHeaderTargetHelpDescription},{column:this.strings.logsHeaderActivitytype,description:this.strings.logsHeaderActivitytypeHelpDescription},{column:this.strings.logsHeaderActivityname,description:this.strings.logsHeaderActivitynameHelpDescription},{column:this.strings.logsHeaderSectionnumber,description:this.strings.logsHeaderSectionnumberHelpDescription},{column:this.strings.logsHeaderSectionname,description:this.strings.logsHeaderSectionnameHelpDescription},{column:this.strings.logsHeaderTimecreated,description:this.strings.logsHeaderTimecreatedHelpDescription}]}else if(a===this.fliplearning_logs){this.helpTitle=this.strings.fliplearningLogsHelpTitle;this.helpDescription=this.strings.fliplearningLogsHelpDescription;this.helpTableItems=[{column:this.strings.logsHeaderLogid,description:this.strings.logsHeaderLogIdHelpDescription},{column:this.strings.logsHeaderUserId,description:this.strings.logsHeaderUserIdHelpDescription},{column:this.strings.logsHeaderUsername,description:this.strings.logsHeaderUsernameHelpDescription},{column:this.strings.logsHeaderFirstname,description:this.strings.logsHeaderFirstnameHelpDescription},{column:this.strings.logsHeaderLastname,description:this.strings.logsHeaderLastnameHelpDescription},{column:this.strings.logsHeaderRoles,description:this.strings.logsHeaderRolesHelpDescription},{column:this.strings.logsHeaderCourseId,description:this.strings.logsHeaderCourseIdHelpDescription},{column:this.strings.logsHeaderCoursename,description:this.strings.logsHeaderCoursenameHelpDescription},{column:this.strings.logsHeaderPluginsection,description:this.strings.logsHeaderPluginsectionHelpDescription},{column:this.strings.logsHeaderComponent,description:this.strings.logsHeaderComponentHelpDescription},{column:this.strings.logsHeaderAction,description:this.strings.logsHeaderActionHelpDescription},{column:this.strings.logsHeaderTarget,description:this.strings.logsHeaderTargetHelpDescription},{column:this.strings.logsHeaderUrl,description:this.strings.logsHeaderUrlHelpDescription},{column:this.strings.logsHeaderTimecreated,description:this.strings.logsHeaderTimecreatedHelpDescription},{column:this.strings.logsHeaderDescription,description:this.strings.logsHeaderDescriptionHelpDescription}]}},saveInteraction:function saveInteraction(a,b,d,e){var f={action:"saveinteraction",pluginsection:this.pluginSectionName,component:a,interaction:b,target:d,url:window.location.href,interactiontype:e,courseid:this.courseId,userid:this.userId};c({method:"get",url:"".concat(M.cfg.wwwroot,"/local/fliplearning/ajax.php"),params:f}).then(function(){}).catch(function(){})}}})}}});
//# sourceMappingURL=logs.min.js.map
