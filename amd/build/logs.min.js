define ("local_fliplearning/logs",["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/alertify","local_fliplearning/pageheader"],function(a,b,c,d,e){"use strict";return{init:function(f){console.log(f);c.defaults.timeout=7200000;a.use(b);a.component("pageheader",e);new a({delimiters:["[[","]]"],el:"#logs",vuetify:new b,data:{strings:f.strings,courseId:f.courseId,userId:f.userId,timezone:f.timezone,dates:[],datesLabels:[],loadingBtnFliplearningLogs:!1,loadingBtnMoodleLogs:!1},mounted:function mounted(){document.querySelector("#logs-loader").style.display="none";document.querySelector("#logs").style.display="block"},computed:{dateRangeText:function dateRangeText(){var a=this,b=this.dates.map(function(a){return new Date(a)});b.sort(this.sortDates);this.datesLabels=b.map(function(b){return a.formatDate(b)});return this.datesLabels.join(" \u2192 ")}},methods:{getHelpContent:function getHelpContent(){var a=[{title:this.strings.sectionHelpTitle,description:this.strings.sectionHelpDescription}];return a},getFile:function getFile(a){var b=this;if(!this.datesLabels.length){d.error("Por favor, selecciona un rango de fechas");return}if("moodle"===a){this.loadingBtnMoodleLogs=!0}else if("fliplearning"===a){this.loadingBtnFliplearningLogs=!0}else{return}var e=this.datesLabels[0].split("/").reverse().join("-"),f=this.datesLabels[1]?this.datesLabels[1].split("/").reverse().join("-"):e;console.log({startdate:e,enddate:f});var g={action:"downloadlogs",logstype:a,userid:this.userId,courseid:this.courseId,startdate:e,enddate:f,url:window.location.href};c({method:"post",url:M.cfg.wwwroot+"/local/fliplearning/ajax.php",timeout:7200000,params:g}).then(function(a){console.log(a);if(200==a.status&&a.data.ok){console.log(a.data);var c=a.data.message,e="".concat(M.cfg.wwwroot,"/local/fliplearning/downloads/").concat(c);console.log({url:e});var f=document.createElement("a");f.href=e;f.click();d.success(b.strings.successDownload)}else if(a.data.message){d.error(a.data.message)}else{d.error(b.strings.apiErrorNetwork)}}).catch(function(){d.error(b.strings.apiErrorNetwork)}).finally(function(){"moodle"===a?b.loadingBtnMoodleLogs=!1:b.loadingBtnFliplearningLogs=!1})},sortDates:function sortDates(c,a){return a.getTime()>c.getTime()?-1:a.getTime()<c.getTime()?1:0},formatDate:function formatDate(a){var b=a.getUTCFullYear(),c=a.getUTCMonth()+1,d=10>c?"0".concat(c):c,e=a.getUTCDate(),f=10>e?"0".concat(e):e;return"".concat(f,"/").concat(d,"/").concat(b)},getTimezone:function getTimezone(){var a="".concat(this.strings.changeTimezone," ").concat(this.timezone);return a}}})}}});
//# sourceMappingURL=logs.min.js.map
