define ("local_fliplearning/grades",["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/axios","local_fliplearning/moment","local_fliplearning/pagination","local_fliplearning/chartcomponent","local_fliplearning/pageheader","local_fliplearning/emailform"],function(a,b,c,d,e,f,g,h){"use strict";return{init:function(c){console.log(c);a.use(b);a.component("pagination",e);a.component("chart",f);a.component("pageheader",g);a.component("emailform",h);var d=new a({delimiters:["[[","]]"],el:"#grades",vuetify:new b,data:function data(){return{strings:c.strings,groups:c.groups,userid:c.userid,courseid:c.courseid,timezone:c.timezone,render_has:c.profile_render,loading:!1,errors:[],pages:c.pages,grades:c.grades,default_category:null,average_categories:[],average_data:[],selected_items:[],item_details:[],grade_item_title:"",grade_item_details_categories:[],grade_item_details_data:[],grade_item_distribution_categories:[],grade_item_distribution_data:[],selected_item:null,grade_item_users:null,selected_users:[],dialog:!1,modulename:"",moduleid:!1,email_strings:c.strings.email_strings}},beforeMount:function beforeMount(){if(this.grades.categories.length){this.default_category=this.grades.categories[0];this.calculate_chart_items_average(this.default_category.items);var a=this.find_first_grade_item(this.default_category.items);this.update_detail_charts(a)}},mounted:function mounted(){document.querySelector("#sessions-loader").style.display="none";document.querySelector("#grades").style.display="block"},computed:{},methods:{get_help_content:function get_help_content(){return"Texto de Ayuda"},changeCategory:function changeCategory(a){this.calculate_chart_items_average(a);var b=this.find_first_grade_item(a);this.update_detail_charts(b)},build_chart_items_average:function build_chart_items_average(){var a={};a.chart={type:"column",backgroundColor:"#FAFAFA"};a.title={text:this.strings.grades_chart_title};a.xAxis={categories:this.average_categories};a.legend={enabled:!1};a.plotOptions={series:{cursor:"pointer",point:{events:{click:function click(){var a=this.x,b=d.selected_items[a];d.update_detail_charts(b)}}}}};a.tooltip={formatter:function formatter(){var a=this.point.x,b=d.selected_items[a],c=this.x,e=(+b.average).toFixed(2),f=b.grademax,g=b.gradecount,h="<b>"+c+"<b> <br/>"+d.strings.grades_tooltip_average+": "+e+"<br/>"+d.strings.grades_tooltip_grade+": "+f+"<br/>"+g+" "+d.strings.grades_tooltip_students+" "+d.grades.student_count+"<br/>";return h}};a.yAxis=[{allowDecimals:!1,labels:{format:"{value} %"},title:{text:this.strings.grades_yaxis_title}}];a.series=[{data:this.average_data}];a.credits={enabled:!1};a.lang={noData:this.strings.no_data};return a},build_chart_item_grade_detail:function build_chart_item_grade_detail(){var a={};a.chart={type:"bar",backgroundColor:"#FAFAFA"};a.title={text:this.grade_item_title};a.subtitle={text:this.strings.grades_details_subtitle};a.xAxis={categories:this.strings.grade_item_details_categories};a.legend={enabled:!1};a.tooltip={formatter:function formatter(){var a=this.x,b=d.selected_item.itemname,c=d.selected_item.grademax,e=0;if(0==this.point.x){e=d.selected_item.maxrating}else if(1==this.point.x){e=d.selected_item.average}else{e=d.selected_item.minrating}e=+e;e=d.isInt(e)?e:e.toFixed(2);var f="<b>"+b+"<b> <br/>"+a+": "+e+"/"+c+"<br/>";return f}};a.yAxis=[{title:{enabled:!1}}];a.series=[{data:this.grade_item_details_data}];a.credits={enabled:!1};a.lang={noData:this.strings.no_data};return a},build_chart_item_grades_distribution:function build_chart_item_grades_distribution(){var a={};a.chart={backgroundColor:"#FAFAFA"};a.title={text:this.grade_item_title};a.subtitle={text:this.strings.grades_distribution_subtitle};a.xAxis={categories:this.grade_item_distribution_categories};a.yAxis=[{title:{text:this.strings.grades_distribution_yaxis_title}}];a.legend={enabled:!1};a.tooltip={formatter:function formatter(){var a=d.strings.grades_distribution_tooltip_prefix,b=d.strings.grades_distribution_tooltip_suffix,c=this.x,e=this.y;return"<b>"+a+"</b> "+c+" <br/>"+e+" "+b}};a.plotOptions={series:{stacking:"normal",borderWidth:1,pointPadding:0,groupPadding:0},column:{point:{events:{click:function click(){var a=this.x;d.selected_users=d.grade_item_users[a];d.email_strings.subject=d.email_strings.subject_prefix+" - "+d.selected_item.itemname;d.dialog=!0}}}}};a.series=[{type:"column",name:"Jane",data:this.grade_item_distribution_data},{type:"spline",name:"Average",data:this.grade_item_distribution_data,marker:{lineWidth:1}}];a.credits={enabled:!1};a.lang={noData:this.strings.no_data};return a},calculate_chart_items_average:function calculate_chart_items_average(a){var b=[],c=[];a.forEach(function(a){b.push(a.average_percentage);c.push(a.itemname)});this.average_categories=c;this.average_data=b;this.selected_items=a},update_detail_charts:function update_detail_charts(a){this.modulename=a.itemmodule;this.moduleid=a.coursemoduleid;this.grade_item_title=a.itemname;this.calculate_chart_item_grade_detail(a);this.calculate_chart_item_grades_distribution(a)},calculate_chart_item_grade_detail:function calculate_chart_item_grade_detail(a){this.selected_item=a;var b=[0,0,0];if(a){b=[+a.maxrating,+a.average,+a.minrating]}this.grade_item_details_data=b},calculate_chart_item_grades_distribution:function calculate_chart_item_grades_distribution(a){var b=this,c=this.strings.grades_greater_than,d=this.strings.grades_smaller_than,e=["".concat(c," 90%"),"".concat(c," 80%"),"".concat(c," 70%"),"".concat(c," 60%"),"".concat(c," 50%"),"".concat(d," 50%")],f=[0,0,0,0,0,0],g=[[],[],[],[],[],[]];if(a){var h=[],i=a.grademax,j=i;[.9,.8,.7,.6,.5,0].forEach(function(a){var b=i*a;h.push({max:j,min:b,count:0});j=b-.1});a.grades.forEach(function(a){h.forEach(function(b,c){if(a.rawgrade>=b.min&&a.rawgrade<=b.max){b.count++;g[c].push(a.user)}})});f=[];h.forEach(function(a,c){var d=b.isInt(a.max)?a.max:a.max.toFixed(1),g=b.isInt(a.min)?a.min:a.min.toFixed(1),h="".concat(d," - ").concat(g,"<br/>").concat(e[c]);e[c]=h;f.push(a.count)})}this.grade_item_users=g;this.grade_item_distribution_categories=e,this.grade_item_distribution_data=f},find_first_grade_item:function find_first_grade_item(a){var b;if(a.length){for(var c=a.length,d=0;d<c;d++){if(0<a[d].maxrating){b=a[d];break}}if(!b){b=a[0]}}return b},isInt:function isInt(a){return 0==a%1},update_dialog:function update_dialog(a){this.dialog=a}}})}}});
//# sourceMappingURL=grades.min.js.map
