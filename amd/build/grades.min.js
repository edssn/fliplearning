define ("local_fliplearning/grades",["local_fliplearning/vue","local_fliplearning/vuetify","local_fliplearning/pagination","local_fliplearning/chartdynamic","local_fliplearning/pageheader","local_fliplearning/emailform","local_fliplearning/helpdialog"],function(a,b,c,d,e,f,g){"use strict";return{init:function(h){a.use(b);a.component("pagination",c);a.component("chart",d);a.component("pageheader",e);a.component("emailform",f);a.component("helpdialog",g);var i=new a({delimiters:["[[","]]"],el:"#grades",vuetify:new b,data:function data(){return{strings:h.strings,groups:h.groups,userid:h.userid,courseid:h.courseid,timezone:h.timezone,render_has:h.profile_render,loading:!1,errors:[],pages:h.pages,grades:h.grades,grade_items_average_colors:h.grade_items_average_colors,item_grades_details_colors:h.item_grades_details_colors,item_grades_distribution_colors:h.item_grades_distribution_colors,default_category:null,average_categories:[],average_data:[],selected_items:[],item_details:[],grade_item_title:"",grade_item_details_categories:[],grade_item_details_data:[],grade_item_distribution_categories:[],grade_item_distribution_data:[],selected_item:null,grade_item_users:null,selected_users:[],dialog:!1,modulename:"",moduleid:!1,email_strings:h.strings.email_strings,help_dialog:!1,help_contents:[]}},beforeMount:function beforeMount(){if(this.grades.categories.length){this.default_category=this.grades.categories[0];this.calculate_chart_items_average(this.default_category.items);var a=this.find_first_grade_item(this.default_category.items);this.update_detail_charts(a)}},mounted:function mounted(){document.querySelector("#sessions-loader").style.display="none";document.querySelector("#grades").style.display="block"},methods:{get_help_content:function get_help_content(){var a=[{title:this.strings.section_help_title,description:this.strings.section_help_description}];return a},change_category:function change_category(a){this.calculate_chart_items_average(a);var b=this.find_first_grade_item(a);this.update_detail_charts(b)},build_grade_items_average_chart:function build_grade_items_average_chart(){var a={};a.chart={type:"column",backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.grade_items_average_colors;a.xAxis={categories:this.average_categories};a.legend={enabled:!1};a.plotOptions={series:{cursor:"pointer",point:{events:{click:function click(){var a=this.x,b=i.selected_items[a];i.update_detail_charts(b)}}}}};a.tooltip={shared:!0,useHTML:!0,formatter:function formatter(){var a=this.points[0].point.x,b=this.y,c=i.selected_items[a],d=c.gradecount,e=this.x,f=i.strings.view_details,g=+c.average,h=this.points[0].color;b=i.isInt(b)?b:b.toFixed(2);g=i.isInt(g)?g:g.toFixed(2);var j=c.grademax;return"<small>"+e+"</small><br/><b style=\"color: "+h+";\">\u2022 </b>"+i.strings.grades_tooltip_average+": "+g+"/"+j+" ("+b+" %)<br/><b style=\"color: "+h+";\">\u2022 </b>"+i.strings.graded_students+": "+d+" "+i.strings.of_conector+" "+i.grades.student_count+"<br/><small>"+f+"</small>"}};a.yAxis=[{allowDecimals:!1,max:100,labels:{format:"{value} %"},title:{text:this.strings.grades_yaxis_title}}];a.series=[{data:this.average_data}];return a},build_item_grades_details_chart:function build_item_grades_details_chart(){var a={};a.chart={type:"bar",backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.item_grades_details_colors;a.xAxis={type:"category"};a.legend={enabled:!1};a.tooltip={shared:!0,useHTML:!0,formatter:function formatter(){var a=this.points[0].key,b=i.selected_item.itemname,c=i.selected_item.grademax,d=this.y,e=this.points[0].color;d=i.isInt(d)?d:d.toFixed(2);return"<small>"+b+"</small> <br/><b style=\"color: "+e+";\">\u2022 </b>"+a+": "+d+"/"+c+"<br/>"}};a.yAxis=[{title:{enabled:!1}}];a.series=[{colorByPoint:!0,data:this.grade_item_details_data}];return a},build_item_grades_distribution_chart:function build_item_grades_distribution_chart(){var a={};a.chart={backgroundColor:null,style:{fontFamily:"poppins"}};a.title={text:null};a.colors=this.item_grades_distribution_colors;a.xAxis={categories:this.grade_item_distribution_categories};a.yAxis=[{title:{text:this.strings.grades_distribution_yaxis_title},allowDecimals:!1}];a.legend={enabled:!1};a.tooltip={useHTML:!0,formatter:function formatter(){var a=i.strings.grades_distribution_tooltip_prefix,b=i.strings.send_mail,c=this.x.split("<br/>")[0]||"Rango",d=this.y,e=i.capitalizeFirstLetter(i.strings.students_text);return"<small>"+a+": "+c+"</small><br/><b style=\"color: "+this.color+";\">\u2022 </b>"+e+": "+d+" <br/><small>"+b+"</small>"}};a.plotOptions={series:{stacking:"normal",borderWidth:1,pointPadding:0,groupPadding:0},column:{point:{events:{click:function click(){var a=this.x;i.selected_users=i.grade_item_users[a];i.email_strings.subject=i.email_strings.subject_prefix+" - "+i.selected_item.itemname;i.dialog=!0}}}}};a.series=[{type:"column",data:this.grade_item_distribution_data},{type:"spline",data:this.grade_item_distribution_data,marker:{lineWidth:1}}];return a},calculate_chart_items_average:function calculate_chart_items_average(a){var b=[],c=[];a.forEach(function(a){b.push(a.average_percentage);c.push(a.itemname)});this.average_categories=c;this.average_data=b;this.selected_items=a},update_detail_charts:function update_detail_charts(a){this.modulename=a.itemmodule;this.moduleid=a.coursemoduleid;this.grade_item_title=a.itemname;this.calculate_chart_item_grade_detail(a);this.calculate_chart_item_grades_distribution(a)},calculate_chart_item_grade_detail:function calculate_chart_item_grade_detail(a){this.selected_item=a;var b=[{name:this.strings.grades_best_grade,y:+a.maxrating||0},{name:this.strings.grades_average_grade,y:+a.average||0},{name:this.strings.grades_worst_grade,y:+a.minrating||0}];this.grade_item_details_data=b},calculate_chart_item_grades_distribution:function calculate_chart_item_grades_distribution(a){var b=this,c=this.strings.grades_greater_than,d=this.strings.grades_smaller_than,e=["".concat(c," 90%"),"".concat(c," 80%"),"".concat(c," 70%"),"".concat(c," 60%"),"".concat(c," 50%"),"".concat(d," 50%")],f=[0,0,0,0,0,0],g=[[],[],[],[],[],[]];if(a){var h=[],i=a.grademax,j=i;[.9,.8,.7,.6,.5,0].forEach(function(a){var b=i*a;h.push({max:j,min:b,count:0});j=b-.1});a.grades.forEach(function(a){h.forEach(function(b,c){if(a.rawgrade>=b.min&&a.rawgrade<=b.max){b.count++;g[c].push(a.user)}})});f=[];h.forEach(function(a,c){var d=b.isInt(a.max)?a.max:a.max.toFixed(1),g=b.isInt(a.min)?a.min:a.min.toFixed(1),h="".concat(d," - ").concat(g,"<br/>").concat(e[c]);e[c]=h;f.push(a.count)})}this.grade_item_users=g;this.grade_item_distribution_categories=e,this.grade_item_distribution_data=f},find_first_grade_item:function find_first_grade_item(a){var b;if(a.length){for(var c=a.length,d=0;d<c;d++){if(0<a[d].maxrating){b=a[d];break}}if(!b){b=a[0]}}return b},isInt:function isInt(a){return 0==a%1},capitalizeFirstLetter:function capitalizeFirstLetter(a){return a.charAt(0).toUpperCase()+a.slice(1)},update_dialog:function update_dialog(a){this.dialog=a},open_chart_help:function open_chart_help(a){var b=[];if("grade_items_average"==a){b.push({title:this.strings.grade_items_average_help_title,description:this.strings.grade_items_average_help_description_p1});b.push({description:this.strings.grade_items_average_help_description_p2});b.push({description:this.strings.grade_items_average_help_description_p3})}else if("item_grades_details"==a){b.push({title:this.strings.item_grades_details_help_title,description:this.strings.item_grades_details_help_description_p1});b.push({description:this.strings.item_grades_details_help_description_p2})}else if("item_grades_distribution"==a){b.push({title:this.strings.item_grades_distribution_help_title,description:this.strings.item_grades_distribution_help_description_p1});b.push({description:this.strings.item_grades_distribution_help_description_p2});b.push({description:this.strings.item_grades_distribution_help_description_p3})}this.help_contents=b;if(this.help_contents.length){this.help_dialog=!0}},update_help_dialog:function update_help_dialog(a){this.help_dialog=a},get_timezone:function get_timezone(){var a="".concat(this.strings.change_timezone," ").concat(this.timezone);return a}}})}}});
//# sourceMappingURL=grades.min.js.map
