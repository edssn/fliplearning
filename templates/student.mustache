<div id="sessions-loader">
    <div class="progressbar-fliplearning">
        <div class="indeterminate"></div>
    </div>
</div>

<v-app id="student" class="fliplearning">
    <v-main>
        <pageheader :pagetitle="strings.title" :helptitle="strings.helplabel" :exitbutton="strings.exitbutton"
                    :helpcontents="get_help_content()" :groups="groups" :courseid="courseid" :userid="userid"></pageheader>
        <v-container pa-8>
            <v-row v-if="loading">
                <span class="mb-1 mt-5 body-1" v-text="strings.graph_generating"></span>
                <v-progress-linear indeterminate color="cyan"></v-progress-linear>
            </v-row>
            <div v-else>

                <v-row>
                    <v-col cols="12" md="6">
                        <v-card class="mx-auto my-3">
                            <v-spacer></v-spacer>

                            <v-card-text>
                                <v-row>
                                    <v-col cols="12" sm="3">
                                        <img :src="get_picture_url(user.id)" height="100" width="100" class="round-avatar"/>
                                    </v-col>
                                    <v-col cols="12" sm="9">
                                        <h1 v-text="get_user_fullname()"></h1>
                                    </v-col>
                                </v-row>
                            </v-card-text>

                            <v-divider ></v-divider>

                            <v-card-text>
                                <v-row>
                                    <v-col>
                                        <span v-text="get_username()"></span>
                                    </v-col>
                                </v-row>
                                <v-row>
                                    <v-col>
                                        <span v-text="user.email"></span>
                                    </v-col>
                                </v-row>
                            </v-card-text>

                            <v-card-actions>
                                <v-btn
                                        color="primary lighten"
                                        v-text="strings.see_profile"
                                        v-on:click="see_profile()"
                                        text
                                >
                                </v-btn>
                            </v-card-actions>
                        </v-card>


                    </v-col>

                    <v-col cols="12" md="6">
                        <v-card elevation="2">
                            <v-card-title class="justify-center" v-text="strings.student_progress_title"></v-card-title>
                            <v-card-text class=text-center>
                                <v-progress-circular
                                    :rotate="-90"
                                    :size="100"
                                    :width="15"
                                    :value="user.progress_percentage"
                                    color="primary"
                                >
                                    <span v-text="get_progress_percentage()"></span>
                                </v-progress-circular>
                            </v-card-text>
                            <v-card-text class=text-center>
                                <span v-text="get_progress_message()"></span>
                            </v-card-text>
                            <br/>
                        </v-card>
                    </v-col>
                </v-row>

                <v-row>
                    <v-col cols="12" sm="12" md="4">
                        <v-card elevation="2">
                            <v-card-title v-text="convert_time(user.inverted_time)">
                            </v-card-title>
                            <v-card-text v-text="strings.inverted_time_title"></v-card-text>
                        </v-card>
                    </v-col>
                    <v-col cols="12" sm="12" md="4">
                        <v-card elevation="2">
                            <v-card-title v-text="user.sessions_number">
                            </v-card-title>
                            <v-card-text v-text="strings.count_sessions_title"></v-card-text>
                        </v-card>
                    </v-col>
                    <v-col cols="12" sm="12" md="4">
                        <v-card elevation="2">
                            <v-card-title v-text="get_student_grade()">
                            </v-card-title>
                            <v-card-text v-text="strings.student_grade_title"></v-card-text>
                        </v-card>
                    </v-col>
                </v-row>

                <v-row>
                    <v-col cols="12" md="6">
                        <chart
                                :container="'modules_access'"
                                :chart="build_modules_access_chart()"
                                :lang="strings.chart"
                        ></chart>
                    </v-col>

                    <v-col cols="12" md="6">
                        <chart
                                :container="'week_sessions'"
                                :chart="build_session_by_weeks_chart()"
                                :lang="strings.chart"
                        ></chart>
                    </v-col>


                </v-row>

                <v-row>
                    <v-col sm="12">
                        <chart
                                :container="'sessions_evolution'"
                                :chart="build_sessions_evolution_chart()"
                                :lang="strings.chart"
                        ></chart>
                    </v-col>
                </v-row>

                <v-row>
                    <v-col sm="12">
                        <chart
                                :container="'user_grades'"
                                :chart="build_user_grades_chart()"
                                :lang="strings.chart"
                        ></chart>
                    </v-col>
                </v-row>



                <v-row>
                    <v-dialog
                            v-model="modules_dialog"
                            max-width="700px"
                    >
                        <v-card>
                            <v-card-title v-text="strings.modules_access_chart_title"></v-card-title>

                            <v-card-text v-for="section in selected_sections" :key="section.id">
                                <v-divider></v-divider>
                                <h4 v-text="section.name"></h4>
                                <div v-for="module in section.modules" :key="module.id">
                                    <img
                                        :src="get_module_icon(module.modname)"
                                        width="25" height="25"
                                    >
                                    <a :href="get_module_url(module)" target="_blank">
                                        <span v-text="module.name"></span>
                                    </a>

                                    <span v-text="get_interactions_number(module.interactions)"></span>

                                    <br/>

                                    <v-chip
                                        v-if="!module.viewed"
                                        color="red"
                                        text-color="white"
                                    >
                                        <v-avatar left>
                                            <v-icon v-text="'mdi-eye-off'" small></v-icon>
                                        </v-avatar>
                                        <span
                                            class="d-flex justify-space-between caption"
                                            v-text="strings.modules_no_viewed"
                                        >
                                        </span>
                                    </v-chip>

                                    <v-chip
                                        v-if="module.viewed"
                                        color="orange"
                                        text-color="white"
                                    >
                                        <v-avatar left>
                                            <v-icon v-text="'mdi-eye'" small></v-icon>
                                        </v-avatar>
                                        <span
                                            class="d-flex justify-space-between caption"
                                            v-text="strings.modules_viewed"
                                        >
                                        </span>
                                    </v-chip>

                                    <v-chip
                                        v-if="module.complete"
                                        color="green"
                                        text-color="white"
                                    >
                                        <v-avatar left>
                                            <v-icon v-text="'mdi-checkbox-marked-circle-outline'" small></v-icon>
                                        </v-avatar>
                                        <span
                                            class="d-flex justify-space-between caption"
                                            v-text="strings.modules_complete"
                                        >
                                        </span>
                                    </v-chip>

                                </div>
                            </v-card-text>

                            <v-card-actions>
                                <v-btn
                                        color="primary darken-1"
                                        text
                                        @click="modules_dialog = false"
                                        v-text="strings.close_button"
                                >
                                </v-btn>
                            </v-card-actions>
                        </v-card>
                    </v-dialog>
                </v-row>

                <v-row class="d-flex justify-center">
                    <span class="overline" v-text="get_timezone()"></span>
                </v-row>
            </div>

        </v-container>
    </v-main>
</v-app>